<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Probabilities of having visited each state by a particular time in a
continuous time Markov model."><title>Passage probabilities — ppass.msm • msm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Passage probabilities — ppass.msm"><meta property="og:description" content="Probabilities of having visited each state by a particular time in a
continuous time Markov model."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">msm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/chjackson/msm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Passage probabilities</h1>
      <small class="dont-index">Source: <a href="https://github.com/chjackson/msm/blob/HEAD/R/outputs.R" class="external-link"><code>R/outputs.R</code></a></small>
      <div class="d-none name"><code>ppass.msm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Probabilities of having visited each state by a particular time in a
continuous time Markov model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ppass.msm</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  qmatrix <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">tot</span>,</span>
<span>  start <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  covariates <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  piecewise.times <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  piecewise.covariates <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"normal"</span>, <span class="st">"bootstrap"</span><span class="op">)</span>,</span>
<span>  cl <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  cores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A fitted multi-state model, as returned by <code><a href="msm.html">msm</a></code>.</p></dd>


<dt>qmatrix</dt>
<dd><p>Instead of <code>x</code>, you can simply supply a transition
intensity matrix in <code>qmatrix</code>.</p></dd>


<dt>tot</dt>
<dd><p>Finite time to forecast the passage probabilites for.</p></dd>


<dt>start</dt>
<dd><p>Starting state (integer).  By default (<code>start="all"</code>),
this will return a matrix one row for each starting state.</p>
<p>Alternatively, this can be used to obtain passage probabilities from a
<em>set</em> of states, rather than single states.  To achieve this,
<code>state</code> is set to a vector of weights, with length equal to the number
of states in the model.  These weights should be proportional to the
probability of starting in each of the states in the desired set, so that
weights of zero are supplied for other states.  The function will calculate
the weighted average of the passage probabilities from each of the
corresponding states.</p></dd>


<dt>covariates</dt>
<dd><p>Covariate values defining the intensity matrix for the
fitted model <code>x</code>, as supplied to <code><a href="qmatrix.msm.html">qmatrix.msm</a></code>.</p></dd>


<dt>piecewise.times</dt>
<dd><p>Currently ignored: not implemented for
time-inhomogeneous models.</p></dd>


<dt>piecewise.covariates</dt>
<dd><p>Currently ignored: not implemented for
time-inhomogeneous models.</p></dd>


<dt>ci</dt>
<dd><p>If <code>"normal"</code>, then calculate a confidence interval by
simulating <code>B</code> random vectors from the asymptotic multivariate normal
distribution implied by the maximum likelihood estimates (and covariance
matrix) of the log transition intensities and covariate effects.</p>
<p>If <code>"bootstrap"</code> then calculate a confidence interval by non-parametric
bootstrap refitting.  This is 1-2 orders of magnitude slower than the
<code>"normal"</code> method, but is expected to be more accurate. See
<code><a href="boot.msm.html">boot.msm</a></code> for more details of bootstrapping in <span class="pkg">msm</span>.</p>
<p>If <code>"none"</code> (the default) then no confidence interval is calculated.</p></dd>


<dt>cl</dt>
<dd><p>Width of the symmetric confidence interval, relative to 1.</p></dd>


<dt>B</dt>
<dd><p>Number of bootstrap replicates.</p></dd>


<dt>cores</dt>
<dd><p>Number of cores to use for bootstrapping using parallel
processing. See <code><a href="boot.msm.html">boot.msm</a></code> for more details.</p></dd>


<dt>...</dt>
<dd><p>Arguments to pass to <code><a href="MatrixExp.html">MatrixExp</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A matrix whose \(r, s\) entry is the probability of having visited
state \(s\) at least once before time \(t\), given the state at time
\(0\) is \(r\).  The diagonal entries should all be 1.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The passage probabilities to state \(s\) are computed by setting the
\(s\)th row of the transition intensity matrix \(Q\) to zero, giving an
intensity matrix \(Q*\) for a simplified model structure where state
\(s\) is absorbing.  The probabilities of passage are then equivalent to
row \(s\) of the transition probability matrix \(Exp(tQ*)\) under this
simplified model for \(t=\)<code>tot</code>.</p>
<p>Note this is different from the probability of occupying each state at
exactly time \(t\), given by <code><a href="pmatrix.msm.html">pmatrix.msm</a></code>.  The passage
probability allows for the possibility of having visited the state before
\(t\), but then occupying a different state at \(t\).</p>
<p>The mean of the passage distribution is the expected first passage time,
<code><a href="efpt.msm.html">efpt.msm</a></code>.</p>
<p>This function currently only handles time-homogeneous Markov models.  For
time-inhomogeneous models the covariates are held constant at the value
supplied, by default the column means of the design matrix over all
observations.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Norris, J. R. (1997) Markov Chains. Cambridge University Press.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="efpt.msm.html">efpt.msm</a></code>, <code><a href="totlos.msm.html">totlos.msm</a></code>,
<code><a href="boot.msm.html">boot.msm</a></code>.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.25</span>, <span class="fl">0</span>, <span class="fl">0.25</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.166</span>, <span class="op">-</span><span class="fl">0.498</span>, <span class="fl">0.166</span>, <span class="fl">0.166</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.25</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ppass[1,2](t) converges to 0.5 with t, since given in state 1, the</span></span></span>
<span class="r-in"><span><span class="co">## probability of going to the absorbing state 4 before visiting state</span></span></span>
<span class="r-in"><span><span class="co">## 2 is 0.5, and the chance of still being in state 1 at t decreases.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ppass.msm</span><span class="op">(</span>qmatrix<span class="op">=</span><span class="va">Q</span>, tot<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]      [,2]       [,3]      [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.00000000 0.3160603 0.04444417 0.3745829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.21468299 1.0000000 0.21468299 0.3091714</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.04444417 0.3160603 1.00000000 0.3745829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.00000000 0.0000000 0.00000000 1.0000000</span>
<span class="r-in"><span><span class="fu">ppass.msm</span><span class="op">(</span>qmatrix<span class="op">=</span><span class="va">Q</span>, tot<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]      [,3]      [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.0000000 0.4999773 0.1990605 0.9862716</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.3992305 1.0000000 0.3992305 0.9841246</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.1990605 0.4999773 1.0000000 0.9862716</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.0000000 0.0000000 0.0000000 1.0000000</span>
<span class="r-in"><span><span class="fu">ppass.msm</span><span class="op">(</span>qmatrix<span class="op">=</span><span class="va">Q</span>, tot<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.0  0.5  0.2    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.4  1.0  0.4    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.2  0.5  1.0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.0  0.0  0.0    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">Q</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>; <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span>; <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Probability of about 1/2 of visiting state 3 by time 10.5, the</span></span></span>
<span class="r-in"><span><span class="co">## median first passage time</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ppass.msm</span><span class="op">(</span>qmatrix<span class="op">=</span><span class="va">Q</span>, tot<span class="op">=</span><span class="fl">10.5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]      [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.0000000 0.9275602 0.5000467</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.6646619 1.0000000 0.6646619</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.5000467 0.9275602 1.0000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Mean first passage time from state 2 to state 3 is 10.02: similar</span></span></span>
<span class="r-in"><span><span class="co">## to the median</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="efpt.msm.html">efpt.msm</a></span><span class="op">(</span>qmatrix<span class="op">=</span><span class="va">Q</span>, tostate<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 14.0241 10.0241  0.0000</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Christopher Jackson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

