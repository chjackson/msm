<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Misclassification probability matrix — ematrix.msm • msm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Misclassification probability matrix — ematrix.msm"><meta name="description" content="Extract the estimated misclassification probability matrix, and
corresponding confidence intervals, from a fitted multi-state model at a
given set of covariate values."><meta property="og:description" content="Extract the estimated misclassification probability matrix, and
corresponding confidence intervals, from a fitted multi-state model at a
given set of covariate values."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">msm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/chjackson/msm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Misclassification probability matrix</h1>
      <small class="dont-index">Source: <a href="https://github.com/chjackson/msm/blob/master/R/outputs.R" class="external-link"><code>R/outputs.R</code></a></small>
      <div class="d-none name"><code>ematrix.msm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Extract the estimated misclassification probability matrix, and
corresponding confidence intervals, from a fitted multi-state model at a
given set of covariate values.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ematrix.msm</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  covariates <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"delta"</span>, <span class="st">"normal"</span>, <span class="st">"bootstrap"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  cl <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  cores <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A fitted multi-state model, as returned by <code><a href="msm.html">msm</a></code></p></dd>


<dt id="arg-covariates">covariates<a class="anchor" aria-label="anchor" href="#arg-covariates"></a></dt>
<dd><p>The covariate values for which to estimate the misclassification probability
matrix.  This can either be:<br></p>
<p>the string <code>"mean"</code>, denoting the means of the covariates in the data
(this is the default),<br></p>
<p>the number <code>0</code>, indicating that all the covariates should be set to
zero,<br></p>
<p>or a list of values, with optional names. For example</p>
<p><code>list (60, 1)</code></p>
<p>where the order of the list follows the order of the covariates originally
given in the model formula, or a named list,</p>
<p><code>list (age = 60, sex = 1)</code></p></dd>


<dt id="arg-ci">ci<a class="anchor" aria-label="anchor" href="#arg-ci"></a></dt>
<dd><p>If <code>"delta"</code> (the default) then confidence intervals are
calculated by the delta method, or by simple transformation of the Hessian
in the very simplest cases.</p>
<p>If <code>"normal"</code>, then calculate a confidence interval by simulating
<code>B</code> random vectors from the asymptotic multivariate normal distribution
implied by the maximum likelihood estimates (and covariance matrix) of the
multinomial-logit-transformed misclassification probabilities and covariate
effects, then transforming back.</p>
<p>If <code>"bootstrap"</code> then calculate a confidence interval by non-parametric
bootstrap refitting.  This is 1-2 orders of magnitude slower than the
<code>"normal"</code> method, but is expected to be more accurate. See
<code><a href="boot.msm.html">boot.msm</a></code> for more details of bootstrapping in <span class="pkg">msm</span>.</p></dd>


<dt id="arg-cl">cl<a class="anchor" aria-label="anchor" href="#arg-cl"></a></dt>
<dd><p>Width of the symmetric confidence interval to present.  Defaults
to 0.95.</p></dd>


<dt id="arg-b">B<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>Number of bootstrap replicates, or number of normal simulations
from the distribution of the MLEs</p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p>Number of cores to use for bootstrapping using parallel
processing. See <code><a href="boot.msm.html">boot.msm</a></code> for more details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with components:</p>
<dl><dt>estimate</dt>
<dd><p>Estimated misclassification probability matrix. The rows
correspond to true states, and columns observed states.</p></dd>

<dt>SE</dt>
<dd><p>Corresponding approximate standard errors.</p></dd>
 <dt>L</dt>
<dd><p>Lower
confidence limits.</p></dd>
 <dt>U</dt>
<dd><p>Upper confidence limits.</p></dd>


</dl><p>Or if <code>ci="none"</code>, then <code>ematrix.msm</code> just returns the estimated
misclassification probability matrix.</p>
<p>The default print method for objects returned by <code>ematrix.msm</code>
presents estimates and confidence limits. To present estimates and standard
errors, do something like</p>
<p><code>ematrix.msm(x)[c("estimates","SE")]</code></p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Misclassification probabilities and covariate effects are estimated on the
multinomial-logit scale by <code><a href="msm.html">msm</a></code>. A covariance matrix is
estimated from the Hessian of the maximised log-likelihood.  From these, the
delta method can be used to obtain standard errors of the probabilities on
the natural scale at arbitrary covariate values.  Confidence intervals are
estimated by assuming normality on the multinomial-logit scale.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="qmatrix.msm.html">qmatrix.msm</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a></p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christopher Jackson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

