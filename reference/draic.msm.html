<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Criteria for comparing two multi-state models with nested state spaces — draic.msm • msm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Criteria for comparing two multi-state models with nested state spaces — draic.msm"><meta name="description" content="A modification of Akaike's information criterion, and a leave-one-out
likelihood cross-validation criterion, for comparing the predictive ability
of two Markov multi-state models with nested state spaces.  This is
evaluated based on the restricted or aggregated data which the models have
in common."><meta property="og:description" content="A modification of Akaike's information criterion, and a leave-one-out
likelihood cross-validation criterion, for comparing the predictive ability
of two Markov multi-state models with nested state spaces.  This is
evaluated based on the restricted or aggregated data which the models have
in common."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">msm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/chjackson/msm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Criteria for comparing two multi-state models with nested state spaces</h1>
      <small class="dont-index">Source: <a href="https://github.com/chjackson/msm/blob/master/R/draic.R" class="external-link"><code>R/draic.R</code></a></small>
      <div class="d-none name"><code>draic.msm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A modification of Akaike's information criterion, and a leave-one-out
likelihood cross-validation criterion, for comparing the predictive ability
of two Markov multi-state models with nested state spaces.  This is
evaluated based on the restricted or aggregated data which the models have
in common.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">draic.msm</span><span class="op">(</span></span>
<span>  <span class="va">msm.full</span>,</span>
<span>  <span class="va">msm.coarse</span>,</span>
<span>  likelihood.only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  information <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"expected"</span>, <span class="st">"observed"</span><span class="op">)</span>,</span>
<span>  tl <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">drlcv.msm</span><span class="op">(</span></span>
<span>  <span class="va">msm.full</span>,</span>
<span>  <span class="va">msm.coarse</span>,</span>
<span>  tl <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  cores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  outfile <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-msm-full">msm.full<a class="anchor" aria-label="anchor" href="#arg-msm-full"></a></dt>
<dd><p>Model on the bigger state space.</p></dd>


<dt id="arg-msm-coarse">msm.coarse<a class="anchor" aria-label="anchor" href="#arg-msm-coarse"></a></dt>
<dd><p>Model on the smaller state space.</p>
<p>The two models must both be non-hidden Markov models without censored
states.</p>
<p>The two models must be fitted to the same datasets, except that the state
space of the coarse model must be an aggregated version of the state space
of the full model.  That is, every state in the full dataset must correspond
to a unique state in the coarse dataset.  For example, for the full state
variable <code>c(1,1,2,2,3,4)</code>, the corresponding coarse states could be
<code>c(1,1,2,2,2,3)</code>, but not <code>c(1,2,3,4,4,4)</code>.</p>
<p>The structure of allowed transitions in the coarse model must also be a
collapsed version of the big model structure, but no check is currently made
for this in the code.</p>
<p>To use these functions, all objects which were used in the calls to fit
<code>msm.full</code> and <code>msm.coarse</code> must be in the working environment,
for example, datasets and definitions of transition matrices.</p></dd>


<dt id="arg-likelihood-only">likelihood.only<a class="anchor" aria-label="anchor" href="#arg-likelihood-only"></a></dt>
<dd><p>Don't calculate Hessians and trace term (DRAIC).</p></dd>


<dt id="arg-information">information<a class="anchor" aria-label="anchor" href="#arg-information"></a></dt>
<dd><p>Use observed or expected information in the DRAIC trace
term.  Expected is the default, and much faster, though is only available
for models fitted to pure panel data (all <code>obstype=1</code> in the call to
<code><a href="msm.html">msm</a></code>, thus not exact transition times or exact death times)</p></dd>


<dt id="arg-tl">tl<a class="anchor" aria-label="anchor" href="#arg-tl"></a></dt>
<dd><p>Width of symmetric tracking interval, by default 0.95 for a 95%
interval.</p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p>Number of processor cores to use in <code>drlcv</code> for
cross-validation by parallel processing.  Requires the <span class="pkg">doParallel</span>
package to be installed.  If not specified, parallel processing is not used.
If <code>cores</code> is set to the string <code>"default"</code>, the default methods
of <code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></code> (on Windows) or
<code><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">registerDoParallel</a></code> (on Unix-like) are used.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Print intermediate results of each iteration of
cross-validation to the console while running. May not work with parallel
processing.</p></dd>


<dt id="arg-outfile">outfile<a class="anchor" aria-label="anchor" href="#arg-outfile"></a></dt>
<dd><p>Output file to print intermediate results of
cross-validation.  Useful to track execution speed when using parallel
processing, where output to the console may not work.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing \(D_{RAIC}\) (<code>draic.msm</code>) or
\(D_{RLCV}\) (<code>drlcv.msm</code>), its component terms, and tracking
intervals.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Note that standard AIC can be computed for one or more fitted <code>msm</code>
models <code>x,y,...</code> using <code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a>(x,y,...)</code>, and this can be used
to compare models fitted to the same data. <code>draic.msm</code> and
<code>drlcv.msm</code> are designed for models fitted to data with
differently-aggregated state spaces.</p>

<p>The difference in restricted AIC (Liquet and Commenges, 2011), as computed
by this function, is defined as</p>
<p>$$D_{RAIC} = l(\gamma_n |\mathbf{x}'' ) - l(\theta_n |\mathbf{x}'' ) +
trace ( J(\theta_n |\mathbf{x}'')J(\theta_n |\mathbf{x})^{-1} - J(\gamma_n
|\mathbf{x}'' )J(\gamma_n |\mathbf{x}' )^{-1})$$</p>
<p>where \(\gamma\) and \(\theta\) are the maximum likelihood
estimates of the smaller and bigger models, fitted to the smaller and bigger
data, respectively.</p>
<p>\(l(\gamma_n |x'')\) represents the likelihood of the
simpler model evaluated on the restricted data.</p>
<p>\(l(\theta_n |x'')\) represents the likelihood of the
complex model evaluated on the restricted data.  This is a hidden Markov
model, with a misclassification matrix and initial state occupancy
probabilities as described by Thom et al (2014).</p>
<p>\(J()\) are the corresponding (expected or observed, as specified by the
user) information matrices.</p>
<p>\(\mathbf{x}\) is the expanded data, to which the bigger model was
originally fitted, and \(\mathbf{x}'\) is the data to which the
smaller model was originally fitted.  \(\mathbf{x}''\) is the
restricted data which the two models have in common.  \(\mathbf{x}'' =
\mathbf{x}'\) in this implementation, so the models are nested.</p>
<p>The difference in likelihood cross-validatory criteria (Liquet and
Commenges, 2011) is defined as</p>
<p>$$D_{RLCV} = 1/n \sum_{i=1}^n \log( h_{X''}(x_i'' | \gamma_{-i}) /
g_{X''}(x_i''| \theta_{-i}))$$</p>
<p>where \(\gamma_{-i}\) and \(\theta_{-i}\) are the maximum likelihood
estimates from the smaller and bigger models fitted to datasets with subject
\(i\) left out, \(g()\) and \(h()\) are the densities of the
corresponding models, and \(x_i''\) is the restricted data from subject
\(i\).</p>
<p>Tracking intervals are analogous to confidence intervals, but not strictly
the same, since the quantity which D_RAIC aims to estimate, the difference
in expected Kullback-Leibler discrepancy for predicting a replicate dataset,
depends on the sample size.  See the references.</p>
<p>Positive values for these criteria indicate the coarse model is preferred,
while negative values indicate the full model is preferred.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Thom, H. and Jackson, C. and Commenges, D. and Sharples, L.
(2015) State selection in multistate models with application to quality of
life in psoriatic arthritis.  Statistics In Medicine 34(16) 2381 - 2480.</p>
<p>Liquet, B. and Commenges D. (2011) Choice of estimators based on different
observations: Modified AIC and LCV criteria. Scandinavian Journal of
Statistics; 38:268-287.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="logLik.msm.html">logLik.msm</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a>, H. H. Z.
Thom <a href="mailto:howard.thom@bristol.ac.uk">howard.thom@bristol.ac.uk</a></p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christopher Jackson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

