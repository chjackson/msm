<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generic function to find quantiles of a distribution — qgeneric • msm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generic function to find quantiles of a distribution — qgeneric"><meta name="description" content="Generic function to find the quantiles of a distribution, given the
equivalent probability distribution function."><meta property="og:description" content="Generic function to find the quantiles of a distribution, given the
equivalent probability distribution function."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">msm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/chjackson/msm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generic function to find quantiles of a distribution</h1>
      <small class="dont-index">Source: <a href="https://github.com/chjackson/msm/blob/v1.8/R/qgeneric.R" class="external-link"><code>R/qgeneric.R</code></a></small>
      <div class="d-none name"><code>qgeneric.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generic function to find the quantiles of a distribution, given the
equivalent probability distribution function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">qgeneric</span><span class="op">(</span><span class="va">pdist</span>, <span class="va">p</span>, special <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pdist">pdist<a class="anchor" aria-label="anchor" href="#arg-pdist"></a></dt>
<dd><p>Probability distribution function, for example,
<code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></code> for the normal distribution, which must be defined in
the current workspace.  This should accept and return vectorised parameters
and values.  It should also return the correct values for the entire real
line, for example a positive distribution should have <code>pdist(x)==0</code> for
\(x&lt;0\).</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>Vector of probabilities to find the quantiles for.</p></dd>


<dt id="arg-special">special<a class="anchor" aria-label="anchor" href="#arg-special"></a></dt>
<dd><p>Vector of character strings naming arguments of the
distribution function that should not be vectorised over. Used, for example,
for the <code>rate</code> and <code>t</code> arguments in <code><a href="pexp.html">qpexp</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>The remaining arguments define parameters of the distribution
<code>pdist</code>.  These MUST be named explicitly.</p>
<p>This may also contain the standard arguments <code>log.p</code> (logical; default
<code>FALSE</code>, if <code>TRUE</code>, probabilities p are given as log(p)), and
<code>lower.tail</code> (logical; if <code>TRUE</code> (default), probabilities are P[X
&lt;= x] otherwise, P[X &gt; x].).</p>
<p>If the distribution is bounded above or below, then this should contain
arguments <code>lbound</code> and <code>ubound</code> respectively, and these will be
returned if <code>p</code> is 0 or 1 respectively.  Defaults to <code>-Inf</code> and
<code>Inf</code> respectively.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Vector of quantiles of the distribution at <code>p</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is intended to enable users to define <code>"q"</code> functions for
new distributions, in cases where the distribution function <code>pdist</code> is
available analytically, but the quantile function is not.</p>
<p>It works by finding the root of the equation \(h(q) = pdist(q) - p = 0\).
Starting from the interval \((-1, 1)\), the interval width is expanded by
50% until \(h()\) is of opposite sign at either end.  The root is then
found using <code><a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">uniroot</a></code>.</p>
<p>This assumes a suitably smooth, continuous distribution.</p>
<p>An identical function is provided in the <span class="pkg">flexsurv</span> package.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Christopher Jackson &lt;chris.jackson@mrc-bsu.cam.ac.uk&gt;</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.959964  1.959964</span>
<span class="r-in"><span><span class="fu">qgeneric</span><span class="op">(</span><span class="va">pnorm</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>, mean<span class="op">=</span><span class="fl">0</span>, sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="co"># must name the arguments</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.959964  1.959964</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christopher Jackson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

