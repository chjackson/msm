<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Hidden Markov model constructors — hmm-dists • msm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Hidden Markov model constructors — hmm-dists"><meta name="description" content="These functions are used to specify the distribution of the response
conditionally on the underlying state in a hidden Markov model.  A list of
these function calls, with one component for each state, should be used for
the hmodel argument to msm. The initial values for the
parameters of the distribution should be given as arguments. Note the
initial values should be supplied as literal values - supplying them as
variables is currently not supported."><meta property="og:description" content="These functions are used to specify the distribution of the response
conditionally on the underlying state in a hidden Markov model.  A list of
these function calls, with one component for each state, should be used for
the hmodel argument to msm. The initial values for the
parameters of the distribution should be given as arguments. Note the
initial values should be supplied as literal values - supplying them as
variables is currently not supported."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">msm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/chjackson/msm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Hidden Markov model constructors</h1>
      <small class="dont-index">Source: <a href="https://github.com/chjackson/msm/blob/master/R/hmm-dists.R" class="external-link"><code>R/hmm-dists.R</code></a></small>
      <div class="d-none name"><code>hmm-dists.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions are used to specify the distribution of the response
conditionally on the underlying state in a hidden Markov model.  A list of
these function calls, with one component for each state, should be used for
the <code>hmodel</code> argument to <code>msm</code>. The initial values for the
parameters of the distribution should be given as arguments. Note the
initial values should be supplied as literal values - supplying them as
variables is currently not supported.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hmmCat</span><span class="op">(</span><span class="va">prob</span>, <span class="va">basecat</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hmmIdent</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hmmUnif</span><span class="op">(</span><span class="va">lower</span>, <span class="va">upper</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hmmNorm</span><span class="op">(</span><span class="va">mean</span>, <span class="va">sd</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hmmLNorm</span><span class="op">(</span><span class="va">meanlog</span>, <span class="va">sdlog</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hmmExp</span><span class="op">(</span><span class="va">rate</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hmmGamma</span><span class="op">(</span><span class="va">shape</span>, <span class="va">rate</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hmmWeibull</span><span class="op">(</span><span class="va">shape</span>, <span class="va">scale</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hmmPois</span><span class="op">(</span><span class="va">rate</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hmmBinom</span><span class="op">(</span><span class="va">size</span>, <span class="va">prob</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hmmBetaBinom</span><span class="op">(</span><span class="va">size</span>, <span class="va">meanp</span>, <span class="va">sdp</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hmmNBinom</span><span class="op">(</span><span class="va">disp</span>, <span class="va">prob</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hmmBeta</span><span class="op">(</span><span class="va">shape1</span>, <span class="va">shape2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hmmTNorm</span><span class="op">(</span><span class="va">mean</span>, <span class="va">sd</span>, lower <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, upper <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hmmMETNorm</span><span class="op">(</span><span class="va">mean</span>, <span class="va">sd</span>, <span class="va">lower</span>, <span class="va">upper</span>, <span class="va">sderr</span>, meanerr <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hmmMEUnif</span><span class="op">(</span><span class="va">lower</span>, <span class="va">upper</span>, <span class="va">sderr</span>, meanerr <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hmmT</span><span class="op">(</span><span class="va">mean</span>, <span class="va">scale</span>, <span class="va">df</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-prob">prob<a class="anchor" aria-label="anchor" href="#arg-prob"></a></dt>
<dd><p>(<code>hmmCat</code>) Vector of probabilities of observing category
<code>1, 2, ...{}, length(prob)</code> respectively.  Or the probability
governing a binomial or negative binomial distribution.</p></dd>


<dt id="arg-basecat">basecat<a class="anchor" aria-label="anchor" href="#arg-basecat"></a></dt>
<dd><p>(<code>hmmCat</code>) Category which is considered to be the
"baseline", so that during estimation, the probabilities are parameterised
as probabilities relative to this baseline category. By default, the
category with the greatest probability is used as the baseline.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>(<code>hmmIdent</code>) Code in the data which denotes the
exactly-observed state.</p></dd>


<dt id="arg-lower">lower<a class="anchor" aria-label="anchor" href="#arg-lower"></a></dt>
<dd><p>(<code>hmmUnif,hmmTNorm,hmmMEUnif</code>) Lower limit for an Uniform
or truncated Normal distribution.</p></dd>


<dt id="arg-upper">upper<a class="anchor" aria-label="anchor" href="#arg-upper"></a></dt>
<dd><p>(<code>hmmUnif,hmmTNorm,hmmMEUnif</code>) Upper limit for an Uniform
or truncated Normal distribution.</p></dd>


<dt id="arg-mean">mean<a class="anchor" aria-label="anchor" href="#arg-mean"></a></dt>
<dd><p>(<code>hmmNorm,hmmLNorm,hmmTNorm</code>) Mean defining a Normal, or
truncated Normal distribution.</p></dd>


<dt id="arg-sd">sd<a class="anchor" aria-label="anchor" href="#arg-sd"></a></dt>
<dd><p>(<code>hmmNorm,hmmLNorm,hmmTNorm</code>) Standard deviation defining a
Normal, or truncated Normal distribution.</p></dd>


<dt id="arg-meanlog">meanlog<a class="anchor" aria-label="anchor" href="#arg-meanlog"></a></dt>
<dd><p>(<code>hmmNorm,hmmLNorm,hmmTNorm</code>) Mean on the log scale, for
a log Normal distribution.</p></dd>


<dt id="arg-sdlog">sdlog<a class="anchor" aria-label="anchor" href="#arg-sdlog"></a></dt>
<dd><p>(<code>hmmNorm,hmmLNorm,hmmTNorm</code>) Standard deviation on the
log scale, for a log Normal distribution.</p></dd>


<dt id="arg-rate">rate<a class="anchor" aria-label="anchor" href="#arg-rate"></a></dt>
<dd><p>(<code>hmmPois,hmmExp,hmmGamma</code>) Rate of a Poisson, Exponential
or Gamma distribution (see <code><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">dpois</a></code>, <code><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">dexp</a></code>,
<code><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></code>).</p></dd>


<dt id="arg-shape">shape<a class="anchor" aria-label="anchor" href="#arg-shape"></a></dt>
<dd><p>(<code>hmmPois,hmmExp,hmmGamma</code>) Shape parameter of a Gamma or
Weibull distribution (see <code><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></code>, <code><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">dweibull</a></code>).</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>(<code>hmmGamma</code>) Scale parameter of a Gamma distribution (see
<code><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></code>), or unstandardised Student t distribution.</p></dd>


<dt id="arg-size">size<a class="anchor" aria-label="anchor" href="#arg-size"></a></dt>
<dd><p>Order of a Binomial distribution (see <code><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">dbinom</a></code>).</p></dd>


<dt id="arg-meanp">meanp<a class="anchor" aria-label="anchor" href="#arg-meanp"></a></dt>
<dd><p>Mean outcome probability in a beta-binomial distribution</p></dd>


<dt id="arg-sdp">sdp<a class="anchor" aria-label="anchor" href="#arg-sdp"></a></dt>
<dd><p>Standard deviation describing the overdispersion of the outcome
probability in a beta-binomial distribution</p></dd>


<dt id="arg-disp">disp<a class="anchor" aria-label="anchor" href="#arg-disp"></a></dt>
<dd><p>Dispersion parameter of a negative binomial distribution, also
called <code>size</code> or <code>order</code>.  (see <code><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">dnbinom</a></code>).</p></dd>


<dt id="arg-shape-shape-">shape1, shape2<a class="anchor" aria-label="anchor" href="#arg-shape-shape-"></a></dt>
<dd><p>First and second parameters of a beta distribution (see
<code><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></code>).</p></dd>


<dt id="arg-sderr">sderr<a class="anchor" aria-label="anchor" href="#arg-sderr"></a></dt>
<dd><p>(<code>hmmMETNorm,hmmUnif</code>) Standard deviation of the Normal
measurement error distribution.</p></dd>


<dt id="arg-meanerr">meanerr<a class="anchor" aria-label="anchor" href="#arg-meanerr"></a></dt>
<dd><p>(<code>hmmMETNorm,hmmUnif</code>) Additional shift in the
measurement error, fixed to 0 by default.  This may be modelled in terms of
covariates.</p></dd>


<dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>Degrees of freedom of the Student t distribution.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Each function returns an object of class <code>hmmdist</code>, which is a
list containing information about the model.  The only component which may
be useful to end users is <code>r</code>, a function of one argument <code>n</code>
which returns a random sample of size <code>n</code> from the given distribution.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>hmmCat</code> represents a categorical response distribution on the set
<code>1, 2, ...{}, length(prob)</code>.  The Markov model with misclassification
is an example of this type of model. The categories in this case are (some
subset of) the underlying states.</p>
<p>The <code>hmmIdent</code> distribution is used for underlying states which are
observed exactly without error.  For hidden Markov models with multiple
outcomes, (see <code><a href="hmmMV.html">hmmMV</a></code>), the outcome in the data which takes the
special <code>hmmIdent</code> value must be the first of the multiple outcomes.</p>
<p><code>hmmUnif</code>, <code>hmmNorm</code>, <code>hmmLNorm</code>, <code>hmmExp</code>,
<code>hmmGamma</code>, <code>hmmWeibull</code>, <code>hmmPois</code>, <code>hmmBinom</code>,
<code>hmmTNorm</code>, <code>hmmNBinom</code> and <code>hmmBeta</code> represent Uniform,
Normal, log-Normal, exponential, Gamma, Weibull, Poisson, Binomial,
truncated Normal, negative binomial and beta distributions, respectively,
with parameterisations the same as the default parameterisations in the
corresponding base R distribution functions.</p>
<p><code>hmmT</code> is the Student t distribution with general mean \(\mu\),
scale \(\sigma\) and degrees of freedom <code>df</code>.  The variance is
\(\sigma^2 df/(df + 2)\).  Note the t distribution in
base R <code><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></code> is a standardised one with mean 0 and scale 1.
These allow any positive (integer or non-integer) <code>df</code>.  By default,
all three parameters, including <code>df</code>, are estimated when fitting a
hidden Markov model, but in practice, <code>df</code> might need to be fixed for
identifiability - this can be done using the <code>fixedpars</code> argument to
<code><a href="msm.html">msm</a></code>.</p>
<p>The <code>hmmMETNorm</code> and <code>hmmMEUnif</code> distributions are truncated
Normal and Uniform distributions, but with additional Normal measurement
error on the response. These are generalisations of the distributions
proposed by Satten and Longini (1996) for modelling the progression of CD4
cell counts in monitoring HIV disease.  See <code><a href="medists.html">medists</a></code> for
density, distribution, quantile and random generation functions for these
distributions.  See also <code><a href="tnorm.html">tnorm</a></code> for density, distribution,
quantile and random generation functions for the truncated Normal
distribution.</p>
<p>See the PDF manual <code class="file">msm-manual.pdf</code> in the <code class="file">doc</code> subdirectory for
algebraic definitions of all these distributions.  New hidden Markov model
response distributions can be added to <span class="pkg">msm</span> by following the
instructions in Section 2.17.1.</p>
<p>Parameters which can be modelled in terms of covariates, on the scale of a
link function, are as follows.</p>
<table class="table table"><tr><td>PARAMETER NAME</td><td>LINK FUNCTION</td></tr><tr><td><code>mean</code></td><td>identity</td></tr><tr><td><code>meanlog</code></td><td>identity</td></tr><tr><td><code>rate</code></td><td>log</td></tr><tr><td><code>scale</code></td><td>log</td></tr><tr><td><code>meanerr</code></td><td>identity</td></tr><tr><td><code>meanp</code></td><td>logit</td></tr><tr><td><code>prob</code></td><td>logit or multinomial logit</td></tr></table><p>Parameters <code>basecat, lower, upper, size, meanerr</code> are fixed at their
initial values. All other parameters are estimated while fitting the hidden
Markov model, unless the appropriate <code>fixedpars</code> argument is supplied
to <code>msm</code>.</p>
<p>For categorical response distributions <code>(hmmCat)</code> the outcome
probabilities initialized to zero are fixed at zero, and the probability
corresponding to <code>basecat</code> is fixed to one minus the sum of the
remaining probabilities.  These remaining probabilities are estimated, and
can be modelled in terms of covariates via multinomial logistic regression
(relative to <code>basecat</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Satten, G.A. and Longini, I.M.  Markov chains with measurement
error: estimating the 'true' course of a marker of the progression of human
immunodeficiency virus disease (with discussion) <em>Applied Statistics</em>
45(3): 275-309 (1996).</p>
<p>Jackson, C.H. and Sharples, L.D. Hidden Markov models for the onset and
progresison of bronchiolitis obliterans syndrome in lung transplant
recipients <em>Statistics in Medicine</em>, 21(1): 113–128 (2002).</p>
<p>Jackson, C.H., Sharples, L.D., Thompson, S.G. and Duffy, S.W. and Couto, E.
Multi-state Markov models for disease progression with classification error.
<em>The Statistician</em>, 52(2): 193–209 (2003).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="msm.html">msm</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a></p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christopher Jackson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

