<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot empirical and fitted survival curves — plot.survfit.msm • msm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot empirical and fitted survival curves — plot.survfit.msm"><meta name="description" content="Plot a Kaplan-Meier estimate of the survival probability and compare it with
the fitted survival probability from a msm model."><meta property="og:description" content="Plot a Kaplan-Meier estimate of the survival probability and compare it with
the fitted survival probability from a msm model."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">msm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/chjackson/msm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot empirical and fitted survival curves</h1>
      <small class="dont-index">Source: <a href="https://github.com/chjackson/msm/blob/master/R/outputs.R" class="external-link"><code>R/outputs.R</code></a></small>
      <div class="d-none name"><code>plot.survfit.msm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plot a Kaplan-Meier estimate of the survival probability and compare it with
the fitted survival probability from a <code>msm</code> model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'survfit.msm'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  from <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  to <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  range <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  covariates <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  interp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"start"</span>, <span class="st">"midpoint"</span><span class="op">)</span>,</span>
<span>  ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"normal"</span>, <span class="st">"bootstrap"</span><span class="op">)</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  legend.pos <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Survival probability"</span>,</span>
<span>  lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  lty.ci <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  lwd.ci <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  col.ci <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  mark.time <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  col.surv <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>  lty.surv <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  lwd.surv <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  survdata <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Output from <code><a href="msm.html">msm</a></code>, representing a fitted multi-state
model object.</p></dd>


<dt id="arg-from">from<a class="anchor" aria-label="anchor" href="#arg-from"></a></dt>
<dd><p>Non-absorbing state from which to consider survival.  Defaults
to state 1.  The fitted probabilities will then be calculated as the
transition probabilities from this state to <code>to</code>.  The empirical
survival curve plots survival from the first observation of <code>from</code>
(where this exists) to the first entry time into <code>to</code>.</p></dd>


<dt id="arg-to">to<a class="anchor" aria-label="anchor" href="#arg-to"></a></dt>
<dd><p>Absorbing state to consider. Defaults to the highest-labelled
absorbing state.</p></dd>


<dt id="arg-range">range<a class="anchor" aria-label="anchor" href="#arg-range"></a></dt>
<dd><p>Vector of two elements, giving the range of times to plot for.</p></dd>


<dt id="arg-covariates">covariates<a class="anchor" aria-label="anchor" href="#arg-covariates"></a></dt>
<dd><p>Covariate values for which to evaluate the expected
probabilities.  This can either be:<br></p>
<p>the string <code>"mean"</code>, denoting the means of the covariates in the data
(this is the default),<br></p>
<p>the number <code>0</code>, indicating that all the covariates should be set to
zero,<br></p>
<p>or a list of values, with optional names. For example</p>
<p><code>list (60, 1)</code></p>
<p>where the order of the list follows the order of the covariates originally
given in the model formula, or a named list,</p>
<p><code>list (age = 60, sex = 1)</code></p>
<p>but note the empirical curve is plotted for the full population.  To
consider subsets for the empirical curve, set <code>survdata=TRUE</code> to
extract the survival data and build a survival plot by hand using
<code><a href="https://rdrr.io/pkg/survival/man/plot.survfit.html" class="external-link">plot.survfit</a></code>.</p></dd>


<dt id="arg-interp">interp<a class="anchor" aria-label="anchor" href="#arg-interp"></a></dt>
<dd><p>If <code>interp="start"</code> (the default) then the entry time
into the absorbing state is assumed to be the time it is first observed in
the data.</p>
<p>If <code>interp="midpoint"</code> then the entry time into the absorbing state is
assumed to be halfway between the time it is first observed and the previous
observation time. This is generally more reasonable for "progressive" models
with observations at arbitrary times.</p></dd>


<dt id="arg-ci">ci<a class="anchor" aria-label="anchor" href="#arg-ci"></a></dt>
<dd><p>If <code>"none"</code> (the default) no confidence intervals are
plotted.  If <code>"normal"</code> or <code>"bootstrap"</code>, confidence intervals are
plotted based on the respective method in <code><a href="pmatrix.msm.html">pmatrix.msm</a></code>. This is
very computationally-intensive, since intervals must be computed at a series
of times.</p></dd>


<dt id="arg-b">B<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>Number of bootstrap or normal replicates for the confidence
interval.  The default is 100 rather than the usual 1000, since these plots
are for rough diagnostic purposes.</p></dd>


<dt id="arg-legend-pos">legend.pos<a class="anchor" aria-label="anchor" href="#arg-legend-pos"></a></dt>
<dd><p>Vector of the \(x\) and \(y\) position, respectively,
of the legend.</p></dd>


<dt id="arg-xlab">xlab<a class="anchor" aria-label="anchor" href="#arg-xlab"></a></dt>
<dd><p>x axis label.</p></dd>


<dt id="arg-ylab">ylab<a class="anchor" aria-label="anchor" href="#arg-ylab"></a></dt>
<dd><p>y axis label.</p></dd>


<dt id="arg-lty">lty<a class="anchor" aria-label="anchor" href="#arg-lty"></a></dt>
<dd><p>Line type for the fitted curve. See <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>.</p></dd>


<dt id="arg-lwd">lwd<a class="anchor" aria-label="anchor" href="#arg-lwd"></a></dt>
<dd><p>Line width for the fitted curve. See <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>.</p></dd>


<dt id="arg-col">col<a class="anchor" aria-label="anchor" href="#arg-col"></a></dt>
<dd><p>Colour for the fitted curve. See <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>.</p></dd>


<dt id="arg-lty-ci">lty.ci<a class="anchor" aria-label="anchor" href="#arg-lty-ci"></a></dt>
<dd><p>Line type for the fitted curve confidence limits. See
<code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>.</p></dd>


<dt id="arg-lwd-ci">lwd.ci<a class="anchor" aria-label="anchor" href="#arg-lwd-ci"></a></dt>
<dd><p>Line width for the fitted curve confidence limits. See
<code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>.</p></dd>


<dt id="arg-col-ci">col.ci<a class="anchor" aria-label="anchor" href="#arg-col-ci"></a></dt>
<dd><p>Colour for the fitted curve confidence limits. See
<code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>.</p></dd>


<dt id="arg-mark-time">mark.time<a class="anchor" aria-label="anchor" href="#arg-mark-time"></a></dt>
<dd><p>Mark the empirical survival curve at each censoring point,
see <code><a href="https://rdrr.io/pkg/survival/man/lines.survfit.html" class="external-link">lines.survfit</a></code>.</p></dd>


<dt id="arg-col-surv">col.surv<a class="anchor" aria-label="anchor" href="#arg-col-surv"></a></dt>
<dd><p>Colour for the empirical survival curve, passed to
<code><a href="https://rdrr.io/pkg/survival/man/lines.survfit.html" class="external-link">lines.survfit</a></code>. See <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>.</p></dd>


<dt id="arg-lty-surv">lty.surv<a class="anchor" aria-label="anchor" href="#arg-lty-surv"></a></dt>
<dd><p>Line type for the empirical survival curve, passed to
<code><a href="https://rdrr.io/pkg/survival/man/lines.survfit.html" class="external-link">lines.survfit</a></code>. See <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>.</p></dd>


<dt id="arg-lwd-surv">lwd.surv<a class="anchor" aria-label="anchor" href="#arg-lwd-surv"></a></dt>
<dd><p>Line width for the empirical survival curve, passed to
<code><a href="https://rdrr.io/pkg/survival/man/lines.survfit.html" class="external-link">lines.survfit</a></code>. See <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>.</p></dd>


<dt id="arg-survdata">survdata<a class="anchor" aria-label="anchor" href="#arg-survdata"></a></dt>
<dd><p>Set to <code>TRUE</code> to return the survival data frame
constructed when plotting the empirical curve.  This can be used for
constructing survival plots by hand using
<code><a href="https://rdrr.io/pkg/survival/man/plot.survfit.html" class="external-link">plot.survfit</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments to be passed to the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></code> function
which draws the fitted curve, or the <code><a href="https://rdrr.io/pkg/survival/man/lines.survfit.html" class="external-link">lines.survfit</a></code>
function which draws the empirical curve.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If the data represent observations of the process at arbitrary times, then
the first occurrence of the absorbing state in the data will usually be
greater than the actual first transition time to that state.  Therefore the
Kaplan-Meier estimate of the survival probability will be an overestimate.</p>
<p>The method of Turnbull (1976) could be used to give a non-parametric
estimate of the time to an interval-censored event, and compared to the
equivalent estimate from a multi-state model.  This is implemented in the
CRAN package <span class="pkg">interval</span> (Fay and Shaw 2010).</p>
<p>This currently only handles time-homogeneous models.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Turnbull, B. W. (1976) The empirical distribution function with
arbitrarily grouped, censored and truncated data. J. R. Statist. Soc. B 38,
290-295.</p>
<p>Fay, MP and Shaw, PA (2010). Exact and Asymptotic Weighted Logrank Tests for
Interval Censored Data: The interval R package. Journal of Statistical
Software. http://www.jstatsoft.org/v36/ i02/. 36 (2):1-34.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></code>,
<code><a href="https://rdrr.io/pkg/survival/man/plot.survfit.html" class="external-link">plot.survfit</a></code>, <code><a href="plot.prevalence.msm.html">plot.prevalence.msm</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christopher Jackson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

