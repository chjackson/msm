<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Extract the estimated transition probability matrix from a fitted
continuous-time multi-state model for a given time interval, at a given set
of covariate values."><title>Transition probability matrix — pmatrix.msm • msm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Transition probability matrix — pmatrix.msm"><meta property="og:description" content="Extract the estimated transition probability matrix from a fitted
continuous-time multi-state model for a given time interval, at a given set
of covariate values."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">msm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/chjackson/msm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Transition probability matrix</h1>
      <small class="dont-index">Source: <a href="https://github.com/chjackson/msm/blob/HEAD/R/outputs.R" class="external-link"><code>R/outputs.R</code></a></small>
      <div class="d-none name"><code>pmatrix.msm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Extract the estimated transition probability matrix from a fitted
continuous-time multi-state model for a given time interval, at a given set
of covariate values.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pmatrix.msm</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  t <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  t1 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  covariates <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"normal"</span>, <span class="st">"bootstrap"</span><span class="op">)</span>,</span>
<span>  cl <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  cores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  qmatrix <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A fitted multi-state model, as returned by <code><a href="msm.html">msm</a></code>.</p></dd>


<dt>t</dt>
<dd><p>The time interval to estimate the transition probabilities for, by
default one unit.</p></dd>


<dt>t1</dt>
<dd><p>The starting time of the interval. Used for models <code>x</code> with
piecewise-constant intensities fitted using the <code>pci</code> option to
<code><a href="msm.html">msm</a></code>. The probabilities will be computed on the interval [t1,
t1+t].</p></dd>


<dt>covariates</dt>
<dd><p>The covariate values at which to estimate the transition
probabilities.  This can either be:<br></p>
<p>the string <code>"mean"</code>, denoting the means of the covariates in the data
(this is the default),<br></p>
<p>the number <code>0</code>, indicating that all the covariates should be set to
zero,<br></p>
<p>or a list of values, with optional names. For example</p>
<p><code>list (60, 1)</code></p>
<p>where the order of the list follows the order of the covariates originally
given in the model formula, or a named list,</p>
<p><code>list (age = 60, sex = 1)</code></p>
<p>If some covariates are specified but not others, the missing ones default to
zero.</p>
<p>For time-inhomogeneous models fitted using the <code>pci</code> option to
<code><a href="msm.html">msm</a></code>, "covariates" here include only those specified using the
<code>covariates</code> argument to <code><a href="msm.html">msm</a></code>, and exclude the artificial
covariates representing the time period.</p>
<p>For time-inhomogeneous models fitted "by hand" by using a time-dependent
covariate in the <code>covariates</code> argument to <code><a href="msm.html">msm</a></code>, the
function <code><a href="pmatrix.piecewise.msm.html">pmatrix.piecewise.msm</a></code> should be used to to calculate
transition probabilities.</p></dd>


<dt>ci</dt>
<dd><p>If <code>"normal"</code>, then calculate a confidence interval for the
transition probabilities by simulating <code>B</code> random vectors from the
asymptotic multivariate normal distribution implied by the maximum
likelihood estimates (and covariance matrix) of the log transition
intensities and covariate effects, then calculating the resulting transition
probability matrix for each replicate. See, e.g. Mandel (2013) for a
discussion of this approach.</p>
<p>If <code>"bootstrap"</code> then calculate a confidence interval by non-parametric
bootstrap refitting.  This is 1-2 orders of magnitude slower than the
<code>"normal"</code> method, but is expected to be more accurate. See
<code><a href="boot.msm.html">boot.msm</a></code> for more details of bootstrapping in <span class="pkg">msm</span>.</p>
<p>If <code>"none"</code> (the default) then no confidence interval is calculated.</p></dd>


<dt>cl</dt>
<dd><p>Width of the symmetric confidence interval, relative to 1.</p></dd>


<dt>B</dt>
<dd><p>Number of bootstrap replicates, or number of normal simulations
from the distribution of the MLEs</p></dd>


<dt>cores</dt>
<dd><p>Number of cores to use for bootstrapping using parallel
processing. See <code><a href="boot.msm.html">boot.msm</a></code> for more details.</p></dd>


<dt>qmatrix</dt>
<dd><p>A transition intensity matrix.  Either this or a fitted model
<code>x</code> must be supplied.  No confidence intervals are available if
<code>qmatrix</code> is supplied.</p></dd>


<dt>...</dt>
<dd><p>Optional arguments to be passed to <code><a href="MatrixExp.html">MatrixExp</a></code> to
control the method of computing the matrix exponential.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The matrix of estimated transition probabilities \(P(t)\) in the
given time.  Rows correspond to "from-state" and columns to "to-state".</p>


<p>Or if <code>ci="normal"</code> or <code>ci="bootstrap"</code>, <code>pmatrix.msm</code></p>


<p>returns a list with components <code>estimates</code> and <code>ci</code>, where
<code>estimates</code> is the matrix of estimated transition probabilities, and
<code>ci</code> is a list of two matrices containing the upper and lower
confidence limits.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For a continuous-time homogeneous Markov process with transition intensity
matrix \(Q\), the probability of occupying state \(s\) at time \(u +
t\) conditionally on occupying state \(r\) at time \(u\) is given by the
\((r,s)\) entry of the matrix \(P(t) = \exp(tQ)\), where
\(\exp()\) is the matrix exponential.</p>
<p>For non-homogeneous processes, where covariates and hence the transition
intensity matrix \(Q\) are piecewise-constant in time, the transition
probability matrix is calculated as a product of matrices over a series of
intervals, as explained in <code><a href="pmatrix.piecewise.msm.html">pmatrix.piecewise.msm</a></code>.</p>
<p>The <code><a href="pmatrix.piecewise.msm.html">pmatrix.piecewise.msm</a></code> function is only necessary for
models fitted using a time-dependent covariate in the <code>covariates</code>
argument to <code><a href="msm.html">msm</a></code>. For time-inhomogeneous models fitted using
"pci", <code>pmatrix.msm</code> can be used, with arguments <code>t</code> and
<code>t1</code>, to calculate transition probabilities over any time period.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Mandel, M. (2013). "Simulation based confidence intervals for
functions with complicated derivatives." The American Statistician
67(2):76-81</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="qmatrix.msm.html">qmatrix.msm</a></code>, <code><a href="pmatrix.piecewise.msm.html">pmatrix.piecewise.msm</a></code>,
<code><a href="boot.msm.html">boot.msm</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>C. H. Jackson <a href="mailto:chris.jackson@mrc-bsu.cam.ac.uk">chris.jackson@mrc-bsu.cam.ac.uk</a>.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Christopher Jackson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

